Rewriting server code in C++11.

TODO:
- implement child server
- write unit tests for child server run()
